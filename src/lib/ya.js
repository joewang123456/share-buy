!function () { function n(n) { return JSON.parse(n) } function t(n) { return JSON.stringify(n) } function e(n) { return encodeURIComponent(n) } function o(n) { return decodeURIComponent(n) } function a(n) { return e(t(n)) } function c(t) { return n(o(t)) } function r(n, t) { for (var e in t) n[e] = t[e]; return console.log(n), n } function s(n, t) { return Array.prototype.slice.call(n, t || 0) } function u(n, t, e) { Object.defineProperty(n, t, { get: e }) } function l(n, t) { var e = "cb_" + ++m; return y[e] = function () { var i = s(arguments); n.apply(w, i), t || (y[e] = null) }, e } function f(n) { h && document.documentElement.removeChild(h), (h = document.createElement("iframe")).setAttribute("width", 0), h.style.display = "none", h.setAttribute("src", n), document.documentElement.appendChild(h), setTimeout(function () { h && document.documentElement.removeChild(h), h = null }, 0) } function d(n) { if (/iting/i.test(g)) { var t = s(arguments, 1), e = t[t.length - 1], i = !0, o = "ios" == v, a = -1 !== n.indexOf("_async"), c = -1 !== n.indexOf("_long"); if (n = n.replace(/(_async|_long)/g, ""), "function" != typeof e ? (i = !1, void 0 === e && (t = t.slice(0, t.length - 1))) : t = t.slice(0, t.length - 1), o || a) { var r = "null"; i && (r = l(e, c)) } if (o) { var u = "jscall://" + n + "&" + r; try { g.match(/iphone os (\d+\_\d+(\_\d+)*)/)[1].split("_")[0] >= 10 && (u = u.replace(/^(jscall:\/\/)/, "$1xmly?")) } catch (n) { } if (t) for (var d in t) u += "&" + t[d]; f(u) } else { var p = window.jscall[n]; if (a) t.unshift(r), p.apply(window.jscall, t); else { var h = p.apply(window.jscall, t); i && e(h) } } } } function p(n, t) { var e; if ("object" != typeof t) return n; for (e in t) t.hasOwnProperty(e) && void 0 != t[e] && (n[e] = t[e]); return n } var h, y = {}, m = 0, g = navigator.userAgent.toLowerCase(), v = window.jscall ? "android" : "ios", w = { _schemeList: { default: "iting", "com.gemd.iting": "itinggemd", "com.qndzq.book": "itingqndzq", "com.jima.yijingtingshu": "itingjima" }, isAndroid: "android" == v, isIos: "ios" == v, setScheme: function (n) { this._schemeList.hasOwnProperty(n) ? this.device.scheme = this._schemeList[n] : this.device.scheme = this._schemeList.default }, device: { name: "", version: "", platformVersion: "", uuid: "", uid: "", token: "", scheme: "iting" }, registModule: function (n, t) { var e = this; u(t, "$ref", function () { return e }), u(e, n, function () { return t }) }, toast: function (n) { d("notificationToast", e(n)) }, copy: function (n) { d("copy", e(n)) }, closeWebView: function () { d("closeWebView") }, browse: function (n) { d("browse", e(n)) }, login: function (t) { d("login_async", function (e) { t && t.call(this, n(e)) }) }, dLogin: function (t) { d("dLogin_async", function (e) { t && t.call(this, n(e)) }) }, getNetworkStatus: function (t) { d("getNetworkStatus_async", function (e) { t && t.call(this, n(e)) }) }, getVersion: function () { return this.device.version || g.match(/(kdtunion_iting|iting)\/(\d(\.\d{1,3}){2,3})/)[2] }, compareVersion: function (n, t) { var e = (t || this.getVersion()).split("."), i = 0, o = null, a = function (n, t) { var e = parseInt(n, 10), i = parseInt(t, 10); return e === i ? 0 : e > i ? 1 : -1 }; return function (n, t) { var e = n[i], c = t[i]; c || !e ? e || !c ? e && c ? 0 === a(e, c) ? (o = 0, (t[++i] || n[i]) && arguments.callee(n, t)) : o = a(e, c) : o = 0 : o = -1 : o = 1 }((n || "0.0.0").split("."), e), o }, ready: function (n) { var t = this; d("appReady", function (e) { var i = t.device; e = JSON.parse(e), i.platformVersion = e.platformVersion, i.name = window.jscall ? "android" : "ios", i.platform = e.platform, i.version = e.version, i.uuid = e.deviceId, i.uid = e.uid, i.token = e.token, i.idfa = e.idfa || "", n.call(t, i) }) }, config: function (n, t) { d("config_async", a(this._wrapFn(n)), function (n) { t && t.call(this, c(n)) }) }, onShare: function (n) { !1 === n ? d("onShare") : d("onShare_async_long", function () { n && n.call(this) }) }, get3rdAuthInfo: function (n, t) { n.type && d("get3rdAuthInfo_async", a(n), function (n) { t && t.call(this, c(n)) }) }, share: function (n, t) { d("share_async", a(n), function (n) { t && t.call(this, c(n)) }) }, multiShare: function (n, t) { d("multiShare_async", a(n), function (n) { t && t.call(this, c(n)) }) }, request: function (n, t) { var e = p({ url: "", data: "", header: { "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8", "X-Requested-With": "XMLHttpRequest" }, type: "GET", dataType: "json" }, n || {}); "" != e.url && (e.contentType && (e.header["Content-Type"] = e.contentType, delete e.contentType), "get" == e.type.toLowerCase() && "object" == typeof e.data && (e.url = this.addExtralParam(e.data, e.url), e.data = ""), d("request_async", a(e), function (n) { t && t.call(this, c(n)) })) }, aliVeriFace: function (n, t) { d("aliVeriFace_async", a(n), function (n) { t && t.call(this, c(n)) }) }, _wrapFn: function (n, t) { var e = !0; if ("boolean" != typeof t || t || (e = !1), "function" == typeof n) return l(n, e); if ("object" == typeof n) for (var i in n) n[i] = this._wrapFn(n[i], t); return n }, notify: function (n) { d("notifyApp", a(n)) }, getScheme: function (n, t) { var e = this.device.scheme, i = this.paramStr(t); return i.length > 0 && (i = "&" + i), e + "://open?msg_type=" + n + i }, open: function (n) { /:\/\/open/.test(n) || (n = this.getScheme.apply(this, arguments)), f(n) }, paramStr: function (n) { var t = "", i = null; if (n) for (var o in n) null != (i = n[o]) && void 0 != i && (t += "&" + e(o) + "=" + e(i)); return t.length > 0 ? t.substring(1) : "" }, cookie: function (i, a, c) { if (0 == arguments.length) { var r = this.getQueryParam(null, document.cookie, ";"); for (var s in r) { r[s] = o(r[s]); try { r[s] = n(r[s]) } catch (n) { } } return r } if (1 == arguments.length) { var u = o(this.getQueryParam(i, document.cookie, ";")); try { return n(u) } catch (n) { return u } } else { var l; c = c || {}, null == a && (c.expires = -1), "object" == typeof a && (a = t(a)), c.expires && (l = new Date).setTime(l.getTime() + 1e3 * c.expires), document.cookie = i + "=" + e(a) + (c.domain ? "; domain=" + c.domain : "") + (c.path ? "; path=" + c.path : "") + (l ? "; expires=" + l.toUTCString() : "") + (c.secure ? "; secure" : "") } }, getQueryParam: function (n, t, e) { var i = {}, o = (t || window.location.search.substring(1)).split(e || "&"); for (var a in o) { var c = o[a].match(/^\s*([%\w]+)=(.*)$/); try { i[c[1]] = c[2] } catch (n) { } } return n ? i[n] : i }, addExtralParam: function (n, t) { var e = /\?(.[^#]*)/, i = "", o = {}; return (i = (t = t || location.href).match(e)) ? (o = r(this.getQueryParam(null, i[1]), n), t.replace(i[1], this.paramStr(o))) : (i = this.paramStr(n), t.indexOf("#") > -1 ? t.replace(/(#.*)$/, "?" + i + "$1") : t + "?" + i) } }; w.registModule("activity", { shareSound: function (n, t, e) { d("appShareSound", n, t, e) }, shareActivity: function (n, t) { d("appShareActivity", n, t) }, shareVote: function (n, t, e) { d("appShareVote", n, t, e) } }), w.registModule("audio", { play: function (n, t) { d("audioPlay", n, function () { t && t.call(w) }) }, pause: function (n) { d("audioPause", function () { n && n.call(w) }) }, playHead: function (n, t) { d("playHead_async", a(n), function (n) { t && t.call(this, c(n)) }) } }), w.registModule("baichuan", { jump: function (n, t) { d("bcJump_async", a(n), t) } }), w.registModule("coupon", { useCoupon: function (n) { d("useCoupon", n) }, shareForCoupon: function (n, t) { d("shareForCoupon_async", a(n), function (n) { t && t.call(this, c(n)) }) } }), w.registModule("image", { captureImage: function (n, t, e) { d("captureImage_async", n, t, e) }, chooseImage: function (t, e) { d("chooseImage_async", a(t), function (t) { cb && cb.call(this, n(data)) }) }, saveImage: function (n) { d("saveImage", e(n)) } }), w.registModule("payment", { getChannels: function (t) { d("getSupportPayType", function (e) { t && t.call(w, n(e)) }) }, pay: function (n, t, e) { var i = e, o = "xmpay"; "string" == typeof t ? o = t : i = t, "xmpay" == o ? this._xmPay(n, i) : "applePay" == o ? this._applePay(n, i) : this._thirdPay(n, i) }, _thirdPay: function (n, t) { var e = "appPay"; this.$ref.compareVersion("5.4.75") <= 0 && (e += "_async"), d(e, a(n), function (e) { var i = c(e); i.data = n, t && t.call(w, i) }) }, _xmPay: function (n, t) { d("xmPay_async", e(n), function (n) { t && t.call(w, o(n)) }) }, _applePay: function (n, t) { d("applePay_async", e(n), function (n) { t && t.call(w, o(n)) }) }, payFinished: function (n) { n && this.$ref.compareVersion("4.3.8") < 0 ? d("payFinished", t(n)) : d("payFinished") } }), w.registModule("game", { getApkStatus: function (n, t) { d("getApkStatus_async_long", a(n), function (n) { t && t.call(this, c(n)) }) }, downloadApk: function (n, t) { d("downloadApk_async", a(n), function (n) { t && t.call(this, c(n)) }) }, installApk: function (n, t) { d("installApk_async", a(n), function (n) { t && t.call(this, c(n)) }) }, launchApk: function (n, t) { d("launchApk_async", a(n), function (n) { t && t.call(this, c(n)) }) }, pauseDownLoad: function (n, t) { d("pauseDownLoad_async", a(n), function (n) { t && t.call(this, c(n)) }) }, resumeDownload: function (n, t) { d("resumeDownload_async", a(n), function (n) { t && t.call(this, c(n)) }) } }), w.registModule("recorder", { recorderEvents: {}, addRecordText: function (n, t) { d("addRecordText_async", a(n), function () { t && t.apply(this, arguments) }) }, startRecord: function (n) { d("startRecord_async", function () { n && n.apply(this, arguments) }) }, pauseRecord: function (n) { d("pauseRecord_async", function () { n && n.apply(this, arguments) }) }, resumeRecord: function (n, t) { d("resumeRecord_async", n, function () { t && t.apply(this, arguments) }) }, stopRecord: function (n) { d("stopRecord_async", function () { n && n.apply(this, arguments) }) }, playVoice: function (n, t) { d("playVoice_async", n, function () { t && t.apply(this, arguments) }) }, pauseVoice: function (n, t) { d("pauseVoice_async", n, function () { t && t.apply(this, arguments) }) }, resumeVoice: function (n, t) { d("resumeVoice_async", n, function () { t && t.apply(this, arguments) }) }, stopVoice: function (n, t) { d("stopVoice_async", n, function () { t && t.apply(this, arguments) }) }, getUploadProgress: function (n, t) { d("getUploadProgress_async", n, function () { t && t.apply(this, arguments) }) }, uploadVoice: function (n, t, e, i) { d("uploadVoice_async", n, t, e, function () { i && i.apply(this, arguments) }) }, _addEvent: function (n, t) { var e = this; e.recorderEvents[n] = t, u(this, n, function () { return e.recorderEvents[n].bind(e.$ref) }) }, bind: function (n, t) { if ("object" == typeof n) for (i in n) this._addEvent(i, n[i]); else "string" == typeof n && this._addEvent(n, t) } }); var _ = { onAudioStatusChange: function (n) { var t, e = JSON.parse(n); document.createEvent ? ((t = document.createEvent("CustomEvent")).initCustomEvent("audioStatusChange", !0, !0, e), document.dispatchEvent(t)) : ((t = document.createEventObject()).eventType = "audioStatusChange", t.detail = e, document.fireEvent("on" + t.eventType, t)) }, getTitle: function () { var n = document.getElementsByTagName("title")[0].innerText; if (!window.jscall || !window.jscall.getTitle) return n; window.jscall.getTitle(n) }, redirectTo: function (n) { window.location.href = n }, resizeWin: function () { window.resizeBy(0, 0) }, getCookie: function (n) { var t = w.cookie(n) || "", e = {}; if (e[n] = t, !window.jscall || !window.jscall.passCookie) return t; window.jscall.passCookie(a(e)) }, paySuccess: function (t) { var e = n(t), i = w.getQueryParam("fromUrl"); return i && (window.config.paySuccessPage = o(i)), e.status ? window.location.href = (window.config.paySuccessPage || "/ting-shang-mobile-web/v1/user/order") + "?orderNo=" + e.orderId + "&device=" + w.device.name + "&version=" + w.device.version : w.toast("支付失败"), "" } }; w.recorder && u(_, "recorder", function () { return w.recorder }), window.ya = w, window.nativeCallBack = y, window.nativeCall = _ }();